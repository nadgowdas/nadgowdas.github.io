<!DOCTYPE html>
<html>

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Shripad Nadgowda


  | It's time we start securing our CICD pipelines

</title>
<meta name="description" content="Tech Preview: Ruminations around Container, Cloud and Security
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üé≤</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2021/pipeline-security/">


<!-- Dark Mode -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>



  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://nadgowdas.github.io/">
       Shripad Nadgowda
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                submenus
                
              </a>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
              
              
                <a class="dropdown-item" href="/publications/">publications</a>
              
              
              
                <div class="dropdown-divider"></div>
              
              
              
                <a class="dropdown-item" href="/projects/">projects</a>
              
              
              </div>
          </li>
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      





<div class="post">

  <header class="post-header">
    <h1 class="post-title">It's time we start securing our CICD pipelines</h1>
    <p class="post-meta">July 21, 2021</p>
    <p class="post-tags">
      <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>
      

      

    </p>
  </header>

  <article class="post-content">
    <p><strong>TL;DR</strong> Automations through CICD pipelines have expedited security scanning and delivery of application to cloud. At the same time such automation functions are being made available <em>ready-to-use</em> in the open marketplaces like tekton catalog or Github Marketplace. Therefore, we  need to start thinking about securing the supply-chain for CICD pipelines itself.</p>

<p>Before diving into the CICD pipeline security discussion, I want to talk about the way open-source ecosystem is influencing different aspects of software lifecycle management, from development, packaging, security scanning and much more. 
Open source ecosystem is growing at an unprecedented pace.  At the same time, it is evolving in different granularities and dimensions. At the platform or infrastructure level we started  with linux to now docker and kubernetes. Personally I believe the major open source expansion is happening  at  application level. We  can roughly categorize this expansion at application level into categories shown below. (In  no way, I claim this list is exhaustive, but it is presented to drive  the  discussion  in  this blog.) These categories or modes of open-source contributions could be viewed as a chronological order of evolution, but there is no evidence to suggest  the later ones are replacing the older modes. In fact, I think there is a tremendous  growth  of contributions  in each  of these categories.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/oss-eval.jpg">
    </div>
</div>
<div class="caption">
    Different currencies of open source contributions/consumptions
</div>

<p>Let‚Äôs first talk about these modes at application level for a moment. At the most  granular level, the open source exchange  happens by sharing the raw code/functions  from  git repositories, stackoverflow,  etc. Next, the <strong>code</strong>  can  be <strong>packaged</strong>, compiled together to be made available as a library or an executable binary. Libraries can be downloaded  from standard package registries like pypi, npm, maven or from OS distros like debian, alpine. While binaries are typically available through release bundles or directly from some object stores (<em>remember how you installed <strong>kubectl</strong> CLI  last time</em>).</p>

<p>Then a big nexus event occurred , i.e. <strong>containers</strong>. (yes, about <em>nexus event</em> ‚Äì <a href="https://www.denofgeek.com/tv/loki-what-is-a-nexus-event/" target="_blank" rel="noopener noreferrer">according to Marvel‚Äôs</a> fantasy universe, nexus event is a significant event that causes a branch to break off from the Sacred Timeline to create new realities) Through container images, we started distributing applications with base OS and language  runtimes and all required package dependencies.  If you need a database, you simply run</p>

<p><code class="language-plaintext highlighter-rouge">docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=don't-tell -d mysql</code>.</p>

<p>But, yes you still had to be responsible for managing lifecycle (scaling/migration) of these applications. Then, with <strong>operators</strong> the onus  of managing lifecycle for applications is switched from  user to open-source operator providers.</p>

<p>Containers allowed breaking monolithic applications and business logic into modular components that can be developed independently and quickly. Such an accelerated development pattern then required a high velocity path from code to container that gave rise to innovation and automation in CICD pipelines. CICD pipelines aim to facilitate expedited testing, security scanning and delivery of applications to cloud through automation. As a result, we are witnessing a new open-source ecosystem around CICD pipelines.</p>

<p>More specifically, I will talk about <em>two</em> CICD technologies I am intimately familiar with, viz. ‚ÄúTekton‚Äù and ‚ÄúGitHub Actions‚Äù. Both these technologies have a growing open-source marketplace where common utility functions (like git-clone, lint-scan..) as well as specialized security and compliance functions (like static-scan, vulnerability-scan..) are made available. Tekton, for instance has <a href="https://github.com/tektoncd/catalog" target="_blank" rel="noopener noreferrer">tektoncd/catalog</a> where more than 50 <em>tasks</em> are available. While GitHub has <a href="https://github.com/marketplace" target="_blank" rel="noopener noreferrer">Marketplace</a>, where more than 800 <em>github actions</em> are available just for code quality checks.</p>

<p>While consumption of open source software allows faster development, it also puts our CICD pipelines at risk from malicious penetration in the supply chain. For example, in the pipeline shown below, individual tasks are authored by different open source vendors. The <em>code-clone</em> task clones given repository and initializes shared workspace for remaining security and compliance tasks. In this case, if the <em>code-clone</em> is compromised in performing its intended desired function, i.e. it adds/updates/removes some code artifacts after cloning the original code, then the analytic performed by remaining tasks is automatically compromised.</p>

<div class="row mt-3">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/assets/img/tekton-pipeline-risk.png">
    </div>
</div>
<div class="caption">
    Sample DevSecOps pipeline with tekton for code scanning
</div>

<p>Thus, as we are building CICD DevSecOps pipelines for securing application scanning and delivery, our pipelines <strong>as-is</strong> can not be the <em>root-of-trust</em>. In other words, we need to make sure our CICD pipelines are ‚Äúsecure‚Äù at the composition to begin with. We are (somewhat) familiar to how we (think we) secure <em>packages</em> and <em>container images</em> by generating SBOM, scanning all dependencies for vulnerabilities, auditing them for licenses, and more. In the wake of recent supply chain attacks, we realized the breadth of the scanning we do is not enough, but let‚Äôs leave it for an another blog. For CICD what it means to start securing pipelines ?</p>

<p>For brevity, let‚Äôs call the <em>tekton tasks</em> or <em>github actions</em> as CICD <strong>functions</strong> and the compositions in which they are used like <em>tekton pipeline</em> or <em>github workflow</em> as simply <strong>pipelines</strong>. Function definitions (tekton-task.yaml or action.yaml) typically has <em>two</em> sections, (a) configuration and (b)execution. Configuration section contains metadata like name, input/output arguments, default values for input arguments, declaration of shared resources and like. While execution section declares a script/binary or an image and an actual command to run. 
Pipeline definition, on the other hand declares order in which these functions can be invoked and pass-on different configuration values to these functions. When we are talking about securing a pipeline, we can start considering following dimensions:</p>

<ol>
  <li>
    <p><strong>Secure Pipeline Layout</strong>: We need to secure the <em>order</em> of execution for functions in the pipeline. We also need to ensure correct Read/Write access to the shared resources for functions.</p>
  </li>
  <li>
    <p><strong>Secure the data flow in the pipeline</strong>: As functions execute inside a pipeline, they typically produce some new artifacts. For instance, <code class="language-plaintext highlighter-rouge">git-clone</code> task would produce a source code clone directory or <code class="language-plaintext highlighter-rouge">vulnerability-scanner</code> would produce a JSON report about discovered vulnerabilities. These artifacts could be input to another function, like vulnerability report can be consumed by <code class="language-plaintext highlighter-rouge">jira-msg</code> to open an issue or <code class="language-plaintext highlighter-rouge">slack-msg</code> to send a message. We need to ensure the data flow within a pipeline is secure as well.</p>
  </li>
  <li>
    <p><strong>Secure Task configurations</strong>: We need to secure integrity of task configurations, such that any changes to the default values, input/output parameters can be signed/verified to be coming from trusted sources.</p>
  </li>
  <li>
    <p><strong>Secure Task Execution Commands</strong>: This is one critical requirement. We need to ensure the execution base (binary/image/script) is coming from trusted source, has no vulnerabilities and <code class="language-plaintext highlighter-rouge">run command</code> has not been tempered by un-authorized sources.</p>
  </li>
  <li>
    <p><strong>Secure innovation of pipeline</strong>: For better usability, pipelines typically offer multiple modes for triggering an execution, for instance manual trigger (<code class="language-plaintext highlighter-rouge">kubectl -f apply pipelinerun.yaml/taskrun.yaml</code>), timed trigger (cronjob scheduled) or event tigger (on pull_request or push from git). So we need a way to verify and authorize the source of the trigger before executing a pipeline.</p>
  </li>
  <li>
    <p><strong>Admission gate for execution</strong> : It never hurts to be double sure:) While we can perform these pipeline security checks by statically scanning the pipeline definitions, it always helps to enfore them at the runtime. So when an authorized event triggers execution of the pipeline, we need to verify pipeline/task/resources/parameters before instantiating the pipeline.</p>
  </li>
</ol>

<p>Then once your pipeline starts executing, there is some great work going-on with <a href="https://github.com/tektoncd/chains/" target="_blank" rel="noopener noreferrer">tektoncd/chains</a> that monitors task executions in the cluster, sign and attest execution state as well as produced artifacts.</p>

<p>Ok, so far we discuss a lot about <em>Why</em> and <em>What</em> about pipeline security theoretically, that leaves us to the practical aspect of <em>How</em>? In the next blog, we will dig deep in evaluating existing and emerging technologies to our need and try to build the right solution.</p>

<p>Again, for inputs or feedback please feel free to reach out to me on Twitter/Github/Email.</p>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    ¬© Copyright 2025 Shripad J. Nadgowda.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

    
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  





</html>
